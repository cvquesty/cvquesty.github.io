
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Questy.org</title>
  <meta name="author" content="Jerald Sheets">

  
  <meta name="description" content="First, Some Philosophy The Puppet Enterprise documentation circa PE 2015.3.2 had some &ldquo;issues&rdquo;. Let me actually preface that, though. &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://questy.org/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Questy.org" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1135877-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >

  <header role="banner"><hgroup>
  <h1><a href="/">Questy.org</a></h1>
  
    <h2>Tech musings and other things...</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="questy.org">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/04/21/scaling-puppet-enterprise-part-iii-additional-compilers/">Scaling Puppet Enterprise - Part III - Additional Compilers</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-21T09:32:47-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2017</span></span> <span class='time'>9:32 am</span></time>
        
           | <a href="/blog/2017/04/21/scaling-puppet-enterprise-part-iii-additional-compilers/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2017/04/21/scaling-puppet-enterprise-part-iii-additional-compilers/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>First, Some Philosophy</h3>

<p>The Puppet Enterprise documentation circa PE 2015.3.2 had some &ldquo;issues&rdquo;. Let me actually preface that, though. Puppet Labs' documentation is by far some of the most voluminous and in many respects most complete vendor documentation out there. I don&rsquo;t mean to disparage their work AT ALL. When it comes to the fact they even have documentation at this level, they&rsquo;re the &ldquo;bees knees&rdquo;. However, I&rsquo;ve always written documentation to fit the &ldquo;grandma rule&rdquo;. If my grandma couldn&rsquo;t read the documentation and follow a step-by-step process to install Puppet successfully, then its just too complex and needs to be simplified.</p>

<p>This causes a problem, of course. There are technologists out there that would become annoyed at repetition, verbosity around &ldquo;understood&rdquo; things, and spelling out each and every step along the way&hellip; even painfully. However, I feel it is the only <em>proper</em> way to document something. My rules are simple.</p>

<pre><code>1. Leave nothing to question
2. Be as verbose and clear as possible
3. Make sure everything is in order, step-by-step
</code></pre>

<p>By following this simple guideline, I feel I&rsquo;m doing more of a service to the reader than if I presumed on their level of sophistication with Puppet, Linux/UNIX, Windows, research capability, Google-foo or whatever.</p>

<p>So let&rsquo;s dive in, shall we?</p>

<hr />

<p><strong><em>You should have completed a split install before beginning this section. You can find the Split Installation documentation at Puppet&rsquo;s Website, or the first installment of this tutorial <a href="http://questy.org/blog/2017/04/18/scaling-puppet-enterprise-part-ii-installation/">here</a>.</em></strong></p>

<h2>HAProxy</h2>

<p>Seemingly counterintuitive, I want to next install the HAProxy we will use as a Load Balancer on the additional compilers.  By installing this first, we can utilize Puppet to install the HAProxy, and manage them automatically rather than doing a lot of ad-hoc work.</p>

<p>Also, by doing the proxy first,  the prerequisites are satisfied in their proper order, the Load Balancer exists before configuring additional compilers (to be able to utilize the dns_alt_names for the load balancer along with the compilers) and to have the GitLab in place and hosting the control_repo before turning on and configuring Code Manager.</p>

<h3>Hardware</h3>

<p>In the initial hardware list, I included a node called &ldquo;Compile Master&rdquo;.  This node  looked like:</p>

<p><img src="http://cvquesty.github.io/images/compile_master_specs.png" alt="Compile Master Specs" /></p>

<p>This node may seem like overkill, but disk and memory are cheap.  If you are scaling at this level, its better to not have to reinstall your Load balancer later. Keep in mind, you don&rsquo;t have to use HAProxy and can use a corporate Load Balancer here, but its configuration is outside the scope of this tutorial.</p>

<p>Once you&rsquo;ve provisioned the load balancer, ssh to the node as the root user, and use the &ldquo;frictionless installer&rdquo; to add your Puppet agent.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -k https://master.example.com:8140/packages/current/install.bash | bash</span></code></pre></td></tr></table></div></figure>


<p>When the client is fully installed, retrieve the Enterprise Console from your browser, and navigate to Nodes | Classification | Unsigned Certificates and select &ldquo;Accept All&rdquo;.  Finally, ssh to the instance as the root user and run <strong><em>puppet agent -t</em></strong> to finish the setup.</p>

<h2>Configure the Load Balancer</h2>

<p>At this point, the node is provisioned and you have a Puppet agent running on it, but you have as of yet not configured the HAProxy Load Balancer for use in the environment. The load balancer will be necessary to have in place prior to adding compile masters to your existing split installation. The following instructions guide you through setting up the HAProxy load balancer.</p>

<ol>
<li><p>SSH to the Puppet Master as root.  <em>(<strong>master.example.com</strong> in our list)</em></p></li>
<li><p>Install the HAPRoxy Forge Module on the master</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>puppet module install puppetlabs-haproxy</span></code></pre></td></tr></table></div></figure>


<p><br>
    <em>leave your root console open while performing steps 3-6</em></p>

<ol>
<li><p>Retrieve the Enterprise Console in your browser</p></li>
<li><p>Select <strong>Nodes</strong> | <strong>Classification</strong></p></li>
<li><p>Create a New Classification Group called &ldquo;<strong>Load Balancer</strong>&rdquo;</p></li>
<li><p>Select the new group from the list and pin the node &ldquo;<strong>compiler.example.com</strong>&rdquo; into the new group.</p></li>
<li><p>In your open SSH session to <strong>master.example.com</strong>, create the profiles module to hold the configuration for HAProxy</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /etc/puppetlabs/code/environments/production/modules
</span><span class='line'>
</span><span class='line'>mkdir -p profiles/manifests
</span><span class='line'>
</span><span class='line'>cd profiles/manifests</span></code></pre></td></tr></table></div></figure>


<ol>
<li><p>Once you have changed to the profiles/manifests directory, create the loadbalancer.pp manifest.</p></li>
<li><p>Follow the documentation <a href="https://forge.puppet.com/puppetlabs/haproxy/readme">here</a> to configure HAProxy. When complete, the loadbalancer.pp manifest should resemble the following with IPs corrected for your particular instance:</p></li>
</ol>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Load Balancer Profile
</span><span class='line'>class profiles::loadbalancer {
</span><span class='line'>
</span><span class='line'>  class { 'haproxy': }
</span><span class='line'>
</span><span class='line'>  # Main Proxy Listener
</span><span class='line'>  haproxy::listen { 'compiler.example.com':
</span><span class='line'>    collect_exported =&gt; false,
</span><span class='line'>    ipaddress        =&gt; $::ipaddress,
</span><span class='line'>    ports            =&gt; '8140',
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  # First Load balanced Compile Master
</span><span class='line'>  haproxy::balancermember { 'compiler1.example.com':
</span><span class='line'>    listening_service =&gt; 'compiler.example.com',
</span><span class='line'>    server_names      =&gt; 'compiler1.example.com',
</span><span class='line'>    ipaddress         =&gt; '10.0.1.24',
</span><span class='line'>    ports             =&gt; '8140',
</span><span class='line'>    options           =&gt; 'check',
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  # Second Load Balanced Compile Master
</span><span class='line'>  haproxy::balancermember { 'compiler2.example.com':
</span><span class='line'>    listening_service =&gt; 'compiler.example.com',
</span><span class='line'>    server_names      =&gt; 'compiler2.example.com',
</span><span class='line'>    ipaddress         =&gt; '10.0.1.25',
</span><span class='line'>    ports             =&gt; '8140',
</span><span class='line'>    options           =&gt; 'check',
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Once you have created this profile, retrieve the Puppet Enterprise Console in your browser and navigate to <strong>Nodes | Classification | Load Balancer</strong>.</p>

<ol>
<li>Selet the <strong>Classes</strong> tab.</li>
<li>Click the &ldquo;refresh&rdquo; button so the console will pick up your new loadbalancer.pp profile to classify your node with.</li>
<li>Under the &ldquo;Add new Class&rdquo; heading, select <strong>profiles::loadbalancer</strong> from the list that drops down.</li>
<li>Click &ldquo;Add Class&rdquo;.</li>
<li>Select &ldquo;Commit 1 Change&rdquo; at the bottom right of the page.</li>
<li>SSH back into <strong>compiler.example.com</strong> and run <strong>puppet agent -t</strong> to configure the Load Balancer.</li>
</ol>


<p>Your Load Balancer is now prepared to balance traffic to two catalog compilers (<em><strong>catalog1.example.com</strong> and <strong>catalog2.example.com</strong></em>) as listed in the above configuration.</p>

<h3>Notes</h3>

<hr />

<p>I noted when putting together the loadbalancer.pp profile above that I had previously used some REALLY ODD ip addresses in the balancer config.  Why? For the life of me I cannot recall. The original file looked like so:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Load Balancer Profile
</span><span class='line'>class profiles::loadbalancer {
</span><span class='line'>
</span><span class='line'>  class { 'haproxy': }
</span><span class='line'>
</span><span class='line'>  # Main Proxy Listener
</span><span class='line'>  haproxy::listen { 'compiler.example.com':
</span><span class='line'>    collect_exported =&gt; false,
</span><span class='line'>    ipaddress        =&gt; $::ipaddress,
</span><span class='line'>    ports            =&gt; '8140',
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  # First Load balanced Compile Master
</span><span class='line'>  haproxy::balancermember { 'compiler1.example.com':
</span><span class='line'>    listening_service =&gt; 'compiler.example.com',
</span><span class='line'>    server_names      =&gt; 'compiler1.example.com',
</span><span class='line'>    ipaddress         =&gt; '10.0.1.24',
</span><span class='line'>    ports             =&gt; '8140',
</span><span class='line'>    options           =&gt; 'check',
</span><span class='line'>  }
</span><span class='line'>
</span><span class='line'>  # Second Load Balanced Compile Master
</span><span class='line'>  haproxy::balancermember { 'compiler2.example.com':
</span><span class='line'>    listening_service =&gt; 'compiler.example.com',
</span><span class='line'>    server_names      =&gt; 'compiler2.example.com',
</span><span class='line'>    ipaddress         =&gt; '10.0.1.25',
</span><span class='line'>    ports             =&gt; '8140',
</span><span class='line'>    options           =&gt; 'check',
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>In my original implementation I set the ipaddres fields with some odd IP addresses. For info around how to fill those but ,the documentation gives some hints:</p>

<blockquote><p>ipaddresses: Optional. Specifies the IP address used to contact the balancermember service. Valid options: a string or an array. If you pass an array, it must contain the same number of elements as the array you pass to the server_names parameter. For each pair of entries in the ipaddresses and server_names arrays, Puppet creates server entries in haproxy.cfg targeting each port specified in the ports parameter. Default: the value of the $::ipaddress fact.</p></blockquote>

<p>Since I was originally setting these up in Digital Ocean, I used the IP space 159.203.x.x which belongs to Digital Ocean. I am guessing these were the hard IPs on the instances I stood up. Since the documentation above states these are optional, you have two options here.  Either leave those lines out of your config altogether, or manually set them to the IP Address of the instance you&rsquo;re using. Try each and do which works for you.</p>

<h2>Conclusion</h2>

<p>Your HAProxy Load balancer is now complete and ready to take traffic to the additional catalog compiler nodes. In installment IV, we&rsquo;ll begin to add in more components along the way to a fully developed LEI of Puppet Enterprise.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/04/18/scaling-puppet-enterprise-part-ii-installation/">Scaling Puppet Enterprise - Part II - Installation</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-18T13:03:21-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>1:03 pm</span></time>
        
           | <a href="/blog/2017/04/18/scaling-puppet-enterprise-part-ii-installation/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2017/04/18/scaling-puppet-enterprise-part-ii-installation/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Installing Puppet Enterprise has been made remarkably easier as time has gone on. The efforts of Puppet Labs (I still can&rsquo;t get used to simply &lsquo;Puppet&rsquo;) to make the installation as seamless and powerful as possible with the simplest of interfaces has been highly successful.</p>

<p>Many changes have occurred over time to include changing from answer files to a <a href="https://docs.puppet.com/pe/latest/config_hocon.html">HOCON</a> formatted <strong>pe.conf</strong> file containing the various configuration elements you may need to stand up an instance. I somewhat preferred the simple nature of the original answer files, but I can see the sense in moving to HOCON moving forward.</p>

<p><strong>Obtain puppet</strong></p>

<p>Needless to say, you&rsquo;re going to need the Puppet Enterprise package to install from. Unlike Puppet Community, the entire installer is provided as a tarball rather than repo based installations via package management, and requires a little bit of UNIX-y knowhow to get it started, as the Puppet Enterprise Server is only installable on Linux.</p>

<p>When you navigate to the Puppet Download page, you may be required to sign up for a free account if you haven&rsquo;t already. The opening download page is found <a href="https://puppet.com/download-puppet-enterprise">here</a>.</p>

<p>You will be presented with a launch page that contains a &ldquo;Download&rdquo; button.  Click the button, and one of two things will happen.  Either you will be directed to a &ldquo;Thank You&rdquo; page or a page to sign up for an account. As you can see, the &ldquo;Thank You&rdquo; page means you already have an account and are signed in whereas the signup page is self-explanatory. Sign up for an account, and retry the download link.</p>

<p>Once you&rsquo;ve made it to the &ldquo;Thank You&rdquo; page, there are three tabs containing &ldquo;Puppet Enterprise Masters&rdquo;, &ldquo;Puppet Enterprise Agents&rdquo;, and &ldquo;Puppet Enterprise Client Tools&rdquo;. As of this writing, the only supported Puppet Master platforms are RedHat 6 &amp; 7, Ubuntu 12.04, 14.04, and 16.04, as well as SLES 11 and 12.</p>

<p>If you had intentions of running the Puppet Master server on any other platform, here is where you realign your expectations.  :)  I have heard that people have hacked the server to run on other platforms, but since we&rsquo;re dealing with Puppet Enterprise, why would you break support and eliminate warranty?  Pick one of the three and download the tarball for your appropriate platform.</p>

<p><strong><em>NOTE:  If You need legacy versions of PE, you can download those <a href="https://puppetlabs.com/misc/pe-files/previous-releases">here</a>.</em></strong></p>

<p><strong>Installation</strong></p>

<p>For the purposes of this scenario, we will be installing the Puppet Infrastructure for fictional super-mega huge company &ldquo;example.com&rdquo;. I am going to trust you have worked out the DNS/Host file naming structure, and can resolve everything everywhere.  If you cannot, don&rsquo;t comment on the post, as I will make fun of you publicly&hellip; you deserve it.</p>

<p>My assumed setup will be:</p>

<p><img src="http://cvquesty.github.io/images/node_list_example_com.png" alt="Example.com Node List" /></p>

<p><strong><em>Automated</em></strong></p>

<p>The Puppet Enterprise Installer is a GUI web-browser based installer. Puppet has gone through the process of giving you a nice frontend to your installation, and making it dead-easy to perform a monolithic as well as split installation.  For our purposes, though, we will be doing a &ldquo;split&rdquo; installation.</p>

<p><strong>Stand up 3 Nodes with the specifications from the first article in the series as follows:</strong></p>

<p><img src="http://cvquesty.github.io/images/split_node_list.png" alt="Split Node List" /></p>

<p>In my experience, I&rsquo;ve found it much easier to exchange root keys between all three of the above nodes to allow the installer to do all it needs to do on each node. You can, however, decide to set the root password to something temporary to hand to the installer as well (and many people opt for this) and then return root&rsquo;s password to your site default.  In any event, all the machines should be able to resolve themselves and each other by name and root should be able to freely ssh between them either via shared keys (easiest) or password.</p>

<p><strong>Transfer the package to the Puppet Master node:</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp -rp puppet-enterprise-2015.3.2-el-7-x86_64.tar.gz root@master.example.com:/root/</span></code></pre></td></tr></table></div></figure>


<p>Once the package is on the destination machine, you should connect to the machine to work with the package on-box:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh root@master.example.com</span></code></pre></td></tr></table></div></figure>


<p>which places you in the root user&rsquo;s home directory where you copied the package.</p>

<p><strong>Extract the Package</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar -zxvf puppet-enterprise-2015.3.2-el-7-x86_64.tar.gz 
</span><span class='line'>cd puppet-enterprise-2015.3.2-el-7-x86_64</span></code></pre></td></tr></table></div></figure>


<p><strong>Run the Installer</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./puppet-enterprise-installer</span></code></pre></td></tr></table></div></figure>


<p>You will receive a text prompt that states:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>??Install packages and guided install [Y,n]</span></code></pre></td></tr></table></div></figure>


<p>Simply press &ldquo;Y&rdquo; or the [Enter] key and the GUI portion of the installation will begin.</p>

<p><strong><em>GUI Installer</em></strong></p>

<p>Once you have started the Installation, the Puppet Enterprise Installer will perform some preparatory steps and then launch an installation interface on your master node on port 3000. To access this interface, you can bring it up in the web browser of your choice at:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>https://master.example.com:3000</span></code></pre></td></tr></table></div></figure>


<p>Navigate to this interface in your Internet browser. When you first arrive at the GUI installer, simply click the &ldquo;Let&rsquo;s Get Started&rdquo; button. On the next page, select &ldquo;Split&rdquo; to begin the Split Installation.The Puppet Enterprise Installer will present you with a GUI questionnaire to fill out regarding your environment. The following is that process in order by section.</p>

<h2>Puppet Master Component</h2>

<ol>
<li><p>Choose the &ldquo;Install on this Server&rdquo; radio button.2. Enter the name of your Master in the <strong>Puppet Master FQDN</strong> text box. (e.g. master.example.com) 3. Enter all appropriate names for your master in the <strong>Puppet Master DNS Aliases</strong> text box.4. Select the &ldquo;Enable Application orchestration&rdquo; check box.## PuppetDB Component</p></li>
<li><p>Enter the hostname of your PuppetDB Node in the <strong>PuppetDB Hostname</strong> text box. (e.g. puppetdb.example.com)</p></li>
<li>Change no other selections under the remainder of the items for this section.</li>
</ol>


<h2>PE Console Component</h2>

<ol>
<li>Enter the hostname of your Puppet Console in the Console Hostname text box. (e.g. console.example.com)</li>
<li>Change no other selections under the remainder of the items for this section.</li>
</ol>


<h3>Database Support</h3>

<p>No changes are needed to is section. Simply leave &ldquo;Install PostgreSQL on the PuppetDB host for me&rdquo; selected.</p>

<h3>Console &lsquo;admin&rsquo; User</h3>

<p>Enter the password you would like to use for the Puppet Enterprise console once your installation is complete in the final text box.</p>

<h2>Final Considerations</h2>

<p>After completing the final section, click the &ldquo;Submit&rdquo; button, and the Puppet Enterprise Installer will present you with a confirmation page for you to review before commencing the installation based on the configuration elements you just provided to the installer.</p>

<p>If everything is to your satisfaction, click the &ldquo;Continue&rdquo; button and the Puppet Enterprise Installation will begin.The Installation progress summary will continue to update you as to the progress of the installation. If you would like to see logging &ldquo;as it happens&rdquo;, you can click the &ldquo;log view&rdquo; button to see that in real time. If you would like to switch back to the summary, simply click the <strong>Summary</strong> button.After what is roughly 10-15 minutes of installation and configuration, the installer will have completed all its work, and you will be presented with a button at the bottom of the progress screen you have been viewing that says: &ldquo;Start Using Puppet Enterprise&rdquo;.  Click that button, and the installer will redirect you to the PE Console login screen.  Enter the admin credentials you created earlier, and you are ready to begin working with the console as needed.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/04/17/scaling-puppet-enterprise/">Scaling Puppet Enterprise</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-17T16:06:11-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>17</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:06 pm</span></time>
        
           | <a href="/blog/2017/04/17/scaling-puppet-enterprise/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2017/04/17/scaling-puppet-enterprise/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In my former life as a consultant, I had to install all manner of configurations of Puppet for clients.  Some were small and some were large, but none were <strong><em>VERY</em></strong> large.  One of the big things I was finding back then was there just wasn&rsquo;t a lot of publicly available information regarding doing a full install and scaling it large.</p>

<p>So, I took some &ldquo;research time&rdquo; on my own and started to build out the configurations according to Puppet Labs' (at the time&hellip; now just &ldquo;Puppet&rdquo;) documentation. The problem I was having was that the docs wouldn&rsquo;t ever lead me to a successful install following a chronolgical set of steps. I had to click into subpages, jump over to sub-sub configurations, and then jump back to the main docs to follow yet another trail down until I reached the end&hellip;lather, rinse, repeat.</p>

<p><strong>Some Caveats..</strong></p>

<p><strong>First</strong>, this is probably no longer a good &ldquo;HOWTO&rdquo; unless you&rsquo;re installing an older Puppet Enterprise. It was created between 2015.2 and 2016.x, and likely has some amount of artifacting related to those versions.</p>

<p><strong>Second</strong>, I&rsquo;m going by docs I&rsquo;ve recorded for my own use.  I wrote these as mentioned above through prototyping, tearing it down, starting again, and literally doing the entire install over and over until it worked &ldquo;as advertised&rdquo;. A lot of this was really just ordering things the right way, and finding documentaiton for various pieces online at Puppet&rsquo;s documentation site as well as blogs, conversations, and plain old trial and error. I certainly can&rsquo;t warrant anything to anybody for any reason. As with most open source/creative commons assets, &ldquo;it works for me, hope it works for you, and if it doesn&rsquo;t, sorry about that.&rdquo;</p>

<p><strong>Finally</strong>, I hope to use this as the springboard to start brain-dumping all my old notes, conversations, ideas, and other prototyping I did in my home lab.  There&rsquo;s still a fair amount of documentation I cannot use or touch because they belong to my former employer or Puppet Labs, so some things may be less than clear and usually because I&rsquo;m dancing around an NDA, noncompete, or just plain being a nice guy. If I inadvertently reveal something I shouldn&rsquo;t, chances are it could disappear without a trace, but I&rsquo;ll still make a note that I removed something, and try and replace whatever it is with published docs.</p>

<p>In short: I want to help the community, but I&rsquo;m walking a tightrope here, so please be kind.</p>

<p><strong>Format</strong></p>

<p>I hope to start easy with a decision making process for installing Puppet, how to choose a method, think about scale, and will likely have quite an opinionated view at times.  Once PE is installed, we&rsquo;ll add compilers, scale postgres, etc. but for starters, I hope to just have the following:</p>

<p>PE Master (MoM)<br>
Puppet DB<br>
PE Console<br>
HA Proxy Node for Compilers<br>
Two Catalog Compilers<br>
One ActiveMQ Hub<br>
Two ActiveMQ Spokes<br>
Two Agent Nodes for testing<br></p>

<p>I know that&rsquo;s quite a number of nodes to get started with, but this after all a large environment infrastructure, and we want to scale big.</p>

<p><strong>Required Nodes</strong></p>

<p>To put together all the required components for a good large installation, I&rsquo;ve settled on the below specs. You can change those as you see fit, but note that some of the disk space requirements and related were due to Puppet&rsquo;s documented requirements <em>at the time</em>.  YMMV, of course, but this is what I consider to be a base level installation if you intend on scaling into the multiple tens of thousands of nodes. Be sure that if you&rsquo;re going to size this down that you&rsquo;re still meeting Puppet&rsquo;s needs in regards to memory, cores, and disk.  <em>(for a current listing of Puppet&rsquo;s reuqirements, you can look <a href="https://docs.puppet.com/pe/latest/sys_req_hw.html">here</a> for more information.)</em></p>

<p><img src="http://cvquesty.github.io/images/prerequisites.png" alt="Puppet_Prerequisites" /></p>

<p>In addition, you&rsquo;ll need to be aware of firewall requirements for such an installation.  Puppet has documentation regarding firewall configurations and needed ports at their website <a href="https://docs.puppet.com/pe/latest/sys_req_sysconfig.html#for-large-environment-installations">here</a>, but I&rsquo;ll insert the image and recount the requirements here.</p>

<p><img src="http://cvquesty.github.io/images/lei_port_diagram.png" alt="Firewall_Ports" /></p>

<p>In short:</p>

<p><img src="http://cvquesty.github.io/images/firewall_ports.png" alt="Firewall_Ports" /></p>

<p>This is a close approximation to what you need to know.  Detailed charts found in the above links, and a &ldquo;point-by-point&rdquo; port and use list is available to review.</p>

<p>In short, I&rsquo;ve found it easiest to have all PE components on the same VLAN with no restrictions between them. If you are going to have a local firewall turned up on each node, you&rsquo;ll need to manage all the above communications as you see fit, but for the serving infrastructure (if in a secure environment, of course) you can likely drop host firewalls in favor of corporate ones.  In short, make it as easy on yourself as you see fit while balancing that toward your corporate security policy.</p>

<p>Finally, make sure DNS and NTP are all ready to go.  I can&rsquo;t tell you the number of times I&rsquo;ve had major issues trying to get all this working, and NTP was off, or DNS didn&rsquo;t propagate as expected (it&rsquo;s always DNS, right?) or some other similar seemingly unrelated piece was not restarted or some such. Just make sure that all nodes resolve to their respective FQDN from all nodes. Obviously, the easiest way to do this is to simply put them all in DNS. You <strong><em>can</em></strong> manage the host files manually, but why would you want to do that?</p>

<p>If you&rsquo;re at this point and all ready to go, look to the next entry to get started.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/08/31/changes-are-afoot/">Changes Are Afoot</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-08-31T10:33:00-04:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>31</span><span class='date-suffix'>st</span>, <span class='date-year'>2016</span></span> <span class='time'>10:33 am</span></time>
        
           | <a href="/blog/2016/08/31/changes-are-afoot/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2016/08/31/changes-are-afoot/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>After much thought and consideration, I&rsquo;ve terminated my employ with ShadowSoft. I was travelling nearly every week all over the US, and not with my family as much as I&rsquo;d like. Unfortunately, this role was a 70% travel role, and our youngest needed Daddy home.</p>

<p><img src="http://cvquesty.github.io/images/paypal.png" alt="PayPal" /></p>

<p>As luck would have it, a totally awesome telecommute FT/Perm option came up with PayPal, and I accepted rather excitedly, and began that role today.  After some getting acquainted with my new duties, you should be seeing/hearing more from me on the Puppet front soon.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/06/13/travel-hiatus/">Travel Hiatus</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-06-13T10:06:29-04:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>10:06 am</span></time>
        
           | <a href="/blog/2016/06/13/travel-hiatus/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2016/06/13/travel-hiatus/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Out</strong></p>

<p>Just a quick update for you all. $work decided at some point that one of the things I was specifically hired for (blogging in the community) some sort of way &ldquo;gives away the farm&rdquo; in regards to Puppet, Puppet Consultation, and related items. As such, I&rsquo;ve been asked not to blog publicly regarding items we deliver as services.</p>

<p>:-(</p>

<p>It likely doesn&rsquo;t matter that much, as I&rsquo;m travelling more than I have in years, and am on-target to exceed 145k miles by Summer&rsquo;s end.  As a result, I will be laying off until I can regroup and find more time.</p>

<p>Sorry, but as they say &ldquo;them&rsquo;s the breaks&rdquo;.</p>

<p>If you need me, you can always find me on the Puppet community Slack Channel #puppet, and my nick there is @cvquesty.</p>

<p>Look for interesting news from me soon.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/10/27/puppetconf-2015/">PuppetConf 2015</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-10-27T22:11:28-04:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:11 pm</span></time>
        
           | <a href="/blog/2015/10/27/puppetconf-2015/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2015/10/27/puppetconf-2015/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>PuppetConf Portland</strong></p>

<p><img src="http://cvquesty.github.io/images/logo.jpg" alt="PuppetConf" /></p>

<p>Ahh, Portland! What a great place to have PuppetConf this year. The home of Puppet Labs and all its varied food, drink, and other unnamed consumables give Portland a vibe like no other.</p>

<p>From the hipster eateries to the burger dives around town, Portland offered something for everyone.</p>

<p>My week began by arriving a tad early for the Puppet Certifed Consultant training day. On the way in, I passed this little beauty right here:</p>

<p><img src="http://cvquesty.github.io/images/mountain.jpg" alt="Mountain" /></p>

<p>I had forgotten just how beautiful the Pacific Northwest can be.</p>

<p>In our meetings before the conference began in earnest, we talked about things announced and things as yet unannounced, and essentially just learned how to be better consultants and puppeteers. It was nice to be able to ask the questions that arise from time to time of the “big boys” (Gary Larizza, Zak Smith, etc.) and get first-hand accounts on how to do better.</p>

<p>There were quite a number of really cool talks on various upcoming tech, that I had quite a bit of opportunity to take notes and build upon knowledge I’d already gained.</p>

<p><strong>Keynotes!!</strong></p>

<p><img src="http://cvquesty.github.io/images/keynote_wide.jpg" alt="KeynoteWide" /></p>

<p>Next up was the PuppetConf Keynotes for the first day that usually contains Luke Kanies' annual Puppet conversation. Where they’ve been, what they’re doing, and the roadmap forward was fodder for Luke’s talk, and you can find the complete Keynote <a href="https://puppetlabs.com/presentations/puppetconf-2015-lukes-keynote-address">here</a>:</p>

<p>The big synopsis I can give is all about application automation. For you Puppeteers out there, just think of the relationships between the File|Package|Service component “types” and apply that to application components (db, web, container, Java App, etc.) and you get the gist. Very cool, very powerful, and very near. Be looking for Puppet Enterprise 2015.3 to drop in the very near future. I’ll certainly have soe blog things to say when that happens.</p>

<p>I appreciate, once again, my employer <a href="http://shadow-soft.com">Shadow Soft</a> sending me out to PuppetConf to be the best engineer I can be, and learn all the new tricks and tools at my disposal while on the road.</p>

<p>Look for me to pick up where I left off with basic tools, and a revamp of my early-on configuration tutorial for Puppet Community with the new tools and features in Puppet 4 soon.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/07/28/some-software-releases-and-forge-stuffs/">Some Software Releases and Forge Stuffs</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-07-28T10:11:55-04:00'><span class='date'><span class='date-month'>Jul</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>10:11 am</span></time>
        
           | <a href="/blog/2015/07/28/some-software-releases-and-forge-stuffs/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2015/07/28/some-software-releases-and-forge-stuffs/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Salutations</strong></p>

<p>First of all, hello from sunny and hot New York. I’m on engagement for my company doing some Puppet goodness in the Northeast.</p>

<p>In my downtime at night, Ive been wrapping up some work I’ve had on my plate for awhile (my Puppet module destined for the Puppet Forge) and generally studying for various topics if for no other reason than to get better.</p>

<p>As I was preparing my new module, Puppet releases the Puppet4 Enterprise release that now follows new semantic versioning schemes, and follows the scheme:</p>

<p>Puppet Enterprise YYYY.VV</p>

<p>where “V” is version number.</p>

<p><strong>Puppet Enterprise</strong></p>

<p>As many of you know, I’ve been maintaining a project for Puppet prototyping and working with development and testing over a Vagrant instance for some time. I created what I have because I needed something I could share with customers to help facilitate coding and iteration without their touching the production instance unless absolutely necessary.</p>

<p>Thus, my projects were born.</p>

<p><strong>Vagrants. Vagrants Everywhere.</strong></p>

<p>In a nutshell, I configure a Vagrant environment on a modern OS. I create 4 nodes. One is the Puppet Master itself and the remaining three are Puppet agents that check in with the master and are in three faux envirnments: “Production”, “Testing”, and “Development”. As a result, you can code for DEV and iterate the heck out of it. Once you like it, you can merge up the tree into testing and finally to production.</p>

<p>These releases have been followng the format:</p>

<p>[OSNAME]|[VERSION NUMBER]-[PUPPET][PUPPETVERSION]</p>

<p>So, for instance, a release for CentOS5 running Puppet Open Source 4.0 would look something like this:</p>

<p>centos5-po4</p>

<p>Make sense?</p>

<p>Well, as of today, my new release will be CentOS7 with Puppet Enterprise 2015.2. It can be found here.</p>

<p><strong>Puppet Forge Module</strong></p>

<p>I’ve also been working on two separate modules for the forge here recently. The other I’ve been working on longer, but this one was just ready first. I call it “PuppetDev”.</p>

<p>The idea behind the PuppetDev module is that sometimes a company who needs to do Puppet Development has corporate policy against using a tool like the Vagrant instances (i.e. virtualization on the desktop) mentioned above. As a result, the company often will set up a centralized development host that people can login to for developing Puppet code.</p>

<p>Often times, though, when starting out, a user can feel overwhelmed at the simple command line in front of them, and even if they get into an editor, they may not know where to start with syntax highlighting and the like.</p>

<p>It was from this need PuppetDev was born. You simply apply the module to a node, and supply the user/group you want to apply the module to as parameters, and it whirls away and sets up their development environment.</p>

<p>Among the toys they get with the release are syntax highlighting, an easier to read colorscheme, a Vim plugin infrastructure, and all manageable by the Puppet Administrator for the site.</p>

<p>I know it’s a rather narrow use case, but there it is… feel free to check it out here, or if you’re so inclined, on your Puppet master you can simply run puppet module install cvquesty/puppetdev.</p>

<p>That’s all I have for this update, but hope to be a little more active here shortly with my next Forge module.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/05/15/organizing-your-hierarchy-equals-pain/">Organizing Your Hierarchy Equals Pain</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-15T17:48:59-04:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>5:48 pm</span></time>
        
           | <a href="/blog/2015/05/15/organizing-your-hierarchy-equals-pain/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2015/05/15/organizing-your-hierarchy-equals-pain/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>The Pain Point</strong></p>

<p>One would think after reading Gary Larizza’s blog that I wouldve come away with the idea that Hiera presents a few issues as it solves a ton… but no. I had to go and think it was easy, fly off half-cocked and try and tackle a big issue or two, unprepared mind you, and here I am… re-discovering what humility should be like.</p>

<p><strong>The Problem</strong></p>

<p>Hiera looks simple. Disarmingly simple. However, the pain doesn’t come in just looking at a nice, default hiera.yaml:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>---
</span><span class='line'>:backends:
</span><span class='line'>- yaml
</span><span class='line'>:hierarchy:
</span><span class='line'>- “%{clientcert}”
</span><span class='line'>- “%{environment}”
</span><span class='line'>- common
</span><span class='line'>:yaml:
</span><span class='line'>:datadir: “/etc/puppetlabs/puppet/environments/%{environment}/hieradata”</span></code></pre></td></tr></table></div></figure>


<p>We can simply look at this and see the wonderful simplicity of how the yaml file is laid out, the ease of adding more hierarchies from which to gain data, and even expand the model to include subdirectories and all sorts of interesting methods of organizing and abstracting our code into usable, organized chunks.</p>

<p>Not so fast.</p>

<p>The real issues begin when you’re dealing with a customer. All too often I find that even they aren’t entirely sure what’s going on in their very own environment, and pushed hard, will actually argue among themselves as to just how everything works. Scary.</p>

<p>The main thing we find ourselves doing is figuring out that last mile… What precisely is the role of machine X in this environment? Ask two people separate from each other, and they’ll likely give different (sometimes remarkably so) answers. Get them together and they may quibble a bit, but generally get to consensus.</p>

<p>This is REALLY, REALLY important. If the folks you’re trying to help aren’t 100% sure exactly:</p>

<p>What a machine does
How a machine is built
What it’s role in the organization is
You’ve got some real issues.</p>

<p><strong>This Doesn’t Suck</strong></p>

<p>Often, engineers look at the Hiera configuration file in a vacuum (so much for the suck joke). Not permanently but definitely independently at first. Then, as the engagement pushes on to defining Roles and Profiles for the site, you have this “oh crap” moment, and throw back to the hierarchy and then start modifying lookup layers, but then jump forward to the profiles where the lookups are (or should be, anyhow) and realize they assumed a different hierarchy. Then, jump back to the hiera.yaml, make changes, then back to the profiles and repeat the process and then finally to the component modules, and remediate any assumptions you made on everythin gyou just changed. Uh oh. Wasted time.</p>

<p>I’ve started working through “all the things” and have come up with a mechanism that works well for me. Hopefully you can gain some mileage from it as well.</p>

<p><strong>First Thing’s First</strong></p>

<p>Some would argue you should do the Hierarchy first while others would argue you do the Profiles first. However, I’ve found that parsing out all the business logic with the team gains a remarkable amount of runway for you to start. Why?</p>

<p>Systems engineers are techno-nerd types. The nuts &amp; bolts, configs and the like are their prime concern and more often than not, they view the site atomically. They can tell you with great detail precisely what each and every machine has installed on it (often…not always), but generally know what the IT ROLE of a node or collection of nodes is for. Further, they can tell you who requested it, what kind of storage may be connected, what business group out there it satisfies the needs of, but with a startling amount of frequency, cannot tell you the BUSINES ROLE of the node.</p>

<p>Q: What is it?<br>
A: A web server.<br>
Q: What’s it’s purpose?<br>
A: To serve web documents, duh!<br>
Q: No, no… what’s it’s business purpose?<br>
A: To make money?<br>
Q: No, no… If you were to give it one overarching purpose, one reason for existing, what would it be?<br>
A: Oh… ummm… I never thought of that before.<br></p>

<p>You’d be surprised just how often you arrive there with pretty much everyone.</p>

<p>As a result, if you wait until mid-engagement to reach this point, (or at least the middle of the writing phase), you’ve got a fair amount of backtracking, and even refactoring to do before you regain some sense of normalcy and can push forward.</p>

<p><strong>Most Specific to Least</strong></p>

<p>As has been said many times and in many ways, your MOST specific designation should always come first. For instance, what is the MOST atomic level of abstraction? Well, the node itself, of course, so the %{clientcert} designator suffices for that.</p>

<p>Well, what’s next? That depends on you. You might have a location to think of (is this data center on the east or west coast, US or Asia). That’s highly broad… maybe not. It might be environment (such as DEV, TEST, PROD). Again, this is custom to you, and that might still be overly broad and you need to find a happy place between clientcert and environment. Only you can tell me that when I’m standing in front of you, so I generally refrain until I can get the layout of your site.</p>

<p>For instance, one customer had clientcert, then location, then environment. That way, items unique to the data center the nodes were in would get handled first, and then things that were environment unique (regardless of location – more broad) could get handled next. See? Custom to them and the way they do business or are arranged technologically.</p>

<p>I “borrowed” the name for this post from Bill Engvall to illustrate a point, that if you just run off to development with no prior knowledge of the things Hiera works with, you will encounter the pain of refactoring at what is most likely the component module level and then the profile level as well. If you’ve ever had to do it, and then do it on a time crunch, truly you have felt the pain.</p>

<p>Avoid it. Think before you act.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/30/puppets-dot-puppets-everywhere/">Puppets.. Puppets Everywhere</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-30T12:52:27-04:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>30</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:52 pm</span></time>
        
           | <a href="/blog/2015/04/30/puppets-dot-puppets-everywhere/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2015/04/30/puppets-dot-puppets-everywhere/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>3.8 is Here!!!</strong></p>

<p>That’s right, kids. PE 3.8 has dropped, and it is quite tasty. Some highlights:</p>

<p><strong>AWS Module Now a Supported Module</strong></p>

<p>As simple as that sounds, it’s huge. Being able to stand up multiple, tens, even hundreds and thousands of servers into AWS at once with Puppet is a great thing, but to have the module supported by Puppet Labs Support is even better.</p>

<p><em>Docker Containers??</em></p>

<p>Indeed. The Node manager now “gets” Docker containers and you can provision from bare metal as needed. Once the provisioning is done, it hands directly off to Puppet to execute the configuration portion of your run. Seet, sweet sauce right there.</p>

<p><em>Bare Metal</em></p>

<p>You’ve always been able to foray into the world of bare metal provisioning, but now it too is supported for you. You can stand up OSes, hypervisors, and then hand those off into the config run using Razor. Razor is now core to PE and also supported by the Puppet Labs Support Team.</p>

<p><em>Code Management</em></p>

<p>A long time coming, you can also manage code deployment to your Puppet Master using r10k, installed by default. Newly dubbed the “Puppet Code Manager”, r10k remains a command line tool, but I hear rumblings there may be some GUI juice on the horizon for this.</p>

<p><strong>Deprecations</strong></p>

<p>As with any release, some Puppet Enterprise features are going the way of the Dodo Bird. Some expected, some surprising, Puppet Enterprise’s landscape is certainly changing.</p>

<p><em>Cloud Provisioner</em></p>

<p>Long decried as a weak part of the PE infrastructure, the newly announced AWS Supported Module renders it redundant, and as such is removed from the shipping product’s default installation. Of course, if you have a large infrastructure that leverages the Cloud Provisioner, you can continue to use it by installing it into PE separately.</p>

<p><em>Live Management</em></p>

<p>Live management, a long-standing feature of the Enterprise Console, is now also deprecated. Of course, with the new code management features “baked-in” to Puppet Enterprise through r10k, Live Management is somewhat redundant. However, Puppet Labs notes that they will be releasing improved resource management functionality in future releases. If you need Live Management, then just as you can with the Cloud Provisioner, you can turn it on as well in the 3.8.0 product.</p>

<p><strong>Compatability</strong></p>

<p>Finally, some older versions of supported OSes are no longer so, and the list is as follows:</p>

<p>centos-5-i386<br>
centos-5-x86_64<br>
centos-6-i386<br>
debian-6-i386<br>
debian-6-x86_64<br>
debian-7-i386<br>
debian-7-x86_64<br>
oracle-5-i386<br>
oracle-5-x86_64<br>
oracle-6-i386<br>
redhat-5-i386<br>
redhat-5-x86_64<br>
redhat-6-i386<br>
scientific-5-i386<br>
scientific-6-i386<br>
sles-11-i386<br>
ubuntu-1004-i386<br>
ubuntu-1004-x86_64<br>
ubuntu-1204-i386<br>
ubuntu-1404-i386<br></p>

<p>I’m sure you may have some of these in your infrastructure, but they’re usually the result of a vendor application’s supported platforms. If so, you may wish to communicate back upstream to your various vendors, because when you upgrade PE, these go away for you.</p>

<p><strong>Try It Out</strong></p>

<p>As usual, I’ve already created a Vagrant instance to allow you to test and work with the new PE, testing out your existing code on the new platform. Check it out on my GitHub here.</p>

<p>Let me know if you find any issues, and happy Puppeting!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/26/some-coding-work-of-late-dot-dot-dot/">Some Coding Work of Late...</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-26T11:26:16-04:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>11:26 am</span></time>
        
           | <a href="/blog/2015/03/26/some-coding-work-of-late-dot-dot-dot/#disqus_thread"
             data-disqus-identifier="http://questy.org/blog/2015/03/26/some-coding-work-of-late-dot-dot-dot/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong><em>I AM NOT A CODER</em></strong></p>

<p>I know that sounds a little silly with all the Coderwall links over there in the sidebar, but I’m not.</p>

<p>I got into this business as a lowly PC building guy, and worked my way into systems administration through light consulting. A necessary evil of the day was tweaking an autoexec.bat &amp; config.sys to release as much memory to the user as was possible for applications. (This was long before Win95, FYI)</p>

<p>As progress and learning would have it, I landed myself a systems administration job and began to grow. Here, 22 years later, back to consulting (but on a much larger scale), I look back on my professional career and see and realize that there’s a LOT of code behind me. Perl, BASH, ksh, HTML, PHP, light Ruby, old DOS debug scripts, Puppet DSL, Expect scripting… tons of it. All encountered and fleshed out in the context of systems engineering and/or management over the years as situations and needs arose.</p>

<p>Fast forward to today. The juxtapostion of Development, QA, and Operations into one big hairy hard-to-define (but getting clearer) term known as “DEVOPS” is the landscape a new admin comes into, and he or she learns from the very beginning the principles of placing infrastructure definition into code, and working as a developer to enhance and automate the hard infrastructure of the operations world.</p>

<p>I say all that to say this… I’ve got some new releases on my GitHub I’d like to share with you to help you out while navigating in this world of DEVOPS. If you have to call me a coder because of it, I may frown, but it is what it is.</p>

<p><strong><em>Vagrant/Virtualbox Fun</em></strong></p>

<p>As I’ve been slowly revealing through my series in past months, there’s a lot of tools out there for working with Puppet and there’s a ton of the same to prototype for your company’s environment. One of these is Vagrant, and it has the ability, in a huge way, to help you automate the setup and teardown of sample infrastructures to work with your Puppet code in. I’ve just updated and released a few of these, and I want to tell you about them.</p>

<p><strong>Vagrant with CentOS 6.5 and PE 3.7.1</strong></p>

<p>If you look here, you’ll find my current project I use with customers. This is a Vagrant instance that turns up a 4-VM environment including a PE Master, a DEV, TEST, and PROD VM running the PE agent, Enterpise Console, Directory Environments pre-configured, r10k configured, and a simple set of Puppet Modules to get you started.</p>

<p>Most commonly, I share those with customers, coworkers, and community folks to get them started coding right away, and to have a platform with which to teach them how to deploy, merge, and promote code through an environment in a smaller version of wat they might already have in their company. This is the enviroment I spoke about at the Atlanta Puppet User’s Group last year in its current iteration.</p>

<p><strong>Vagrant with CentOS7 and PE 3.7.2</strong></p>

<p>Similarly, you can find a CentOS7 + PE 3.7.2 project here. Much like the above, you get the latest of PE with CentOS7 to help your prototyping over a more current OS.</p>

<p><strong>Vagrant with CentOS7 and Puppet OSS 4</strong></p>

<p>If you look up the word “experiemental” in the dictionary, this project right here is linked as an example.</p>

<p>I’ve gotten a very rudimentary working setup of a Master and one agent to install completely and autosign, and haven’t even scratched the surface of all the new goodies in Puppet 4. As Puppet 4 is still in Beta, this is not recommended in any way for any reason at any time for you to use for any purpose. :)</p>

<p>My hope here is to prepare myself for the PE4 features long before they’re released. I hope to work on getting directory environments and r10k working for this only to have a base from which to rapidly develop for PE4 when it’s released. <strong>EXPECT THIS ONE TO GO AWAY IN FAVOR OF THE NEW PROJECT.</strong></p>

<p><strong>YOU HAVE BEEN WARNED</strong></p>

<p>I hope these projects assist you in rapidly creating a platform and developing for Puppet. If you have any questions, don’t hesitate to contact me via jsheets@shadow-soft.com, quest@questy.org, or one of the many other social media nexii you have available to you.</p>

<p>As always, these are in active, deep development. If you’ve got some Vagrant chops and/or want to contribute in any way, feel free to do pull requests, and I’ll integrate changes as soon as I’m able between customer engagements and/or other duties I may have here at Shadow-Soft.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/04/21/scaling-puppet-enterprise-part-iii-additional-compilers/">Scaling Puppet Enterprise - Part III - Additional Compilers</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/04/18/scaling-puppet-enterprise-part-ii-installation/">Scaling Puppet Enterprise - Part II - Installation</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/04/17/scaling-puppet-enterprise/">Scaling Puppet Enterprise</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/08/31/changes-are-afoot/">Changes Are Afoot</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/06/13/travel-hiatus/">Travel Hiatus</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/CVQuesty">@CVQuesty</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'CVQuesty',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





<section>
<div class="fb-like-box" data-href="http://www.facebook.com/jerald.sheets" data-width="260" data-show-faces="true" data-stream="true" data-header=""   ></div>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Jerald Sheets -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'questy-org';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
